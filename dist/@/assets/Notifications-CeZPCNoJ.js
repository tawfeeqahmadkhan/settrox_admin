import{j as e,r as l,d as n,L as E}from"./index-CMwVzeIB.js";import{u as F,N as c,w as P,a as y,S as $,x as L}from"./Layout-BjD68e0c.js";import{P as O}from"./PageTitle-CiYCa1gH.js";import{a as x,n as u}from"./toast-Bi8odYBa.js";import"./iconBase-E_75oB0f.js";import"./useDispatch-DX3rZxrl.js";import"./httpService-y4n1pDxN.js";/* empty css                      */const w=({id:r,name:d,type:g,handleClick:f,isChecked:N})=>e.jsx("input",{id:r,name:d,type:g,onChange:f,checked:N}),V=()=>{const[r,d]=l.useState([]),[g,f]=l.useState(0),[N,m]=l.useState(0),[k,p]=l.useState(2),[o,h]=l.useState([]),[j,C]=l.useState(!1),{showDateTimeFormat:D}=F(),S=async a=>{var i,s;try{await c.updateStatusNotification(a,{status:"read"});const t=await c.getAllNotification();d(t==null?void 0:t.notifications),m(t==null?void 0:t.totalUnreadDoc),window.location.reload(!1)}catch(t){x(((s=(i=t==null?void 0:t.response)==null?void 0:i.data)==null?void 0:s.message)||(t==null?void 0:t.message))}},T=async a=>{var i,s;try{await c.deleteNotification(a);const t=await c.getAllNotification();d(t==null?void 0:t.notifications),m(t==null?void 0:t.totalUnreadDoc),f(t==null?void 0:t.totalDoc)}catch(t){x(((s=(i=t==null?void 0:t.response)==null?void 0:i.data)==null?void 0:s.message)||(t==null?void 0:t.message))}},U=async a=>{var i,s;try{const t=await c.getAllNotification(a);d(b=>[...b,...t==null?void 0:t.notifications]),m(t==null?void 0:t.totalUnreadDoc),p(b=>b+1)}catch(t){x(((s=(i=t==null?void 0:t.response)==null?void 0:i.data)==null?void 0:s.message)||(t==null?void 0:t.message))}},B=async()=>{var a,i;try{const s=await c.updateManyStatusNotification({ids:o,status:"read"});h([]),u(s.message),p(1);const t=await c.getAllNotification();d(t==null?void 0:t.notifications),m(t==null?void 0:t.totalUnreadDoc)}catch(s){x(((i=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:i.message)||(s==null?void 0:s.message))}},I=async()=>{var a,i;try{const s=await c.deleteManyNotification({ids:o});u(s.message),h([]),p(1);const t=await c.getAllNotification();d(t==null?void 0:t.notifications),m(t==null?void 0:t.totalUnreadDoc)}catch(s){x(((i=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:i.message)||(s==null?void 0:s.message))}},M=()=>{C(!j),h(r==null?void 0:r.map(a=>a._id)),j&&h([])},_=a=>{const{id:i,checked:s}=a.target;h([...o,i]),s||h(o.filter(t=>t!==i))};return l.useEffect(()=>{(async()=>{var a,i;try{const s=await c.getAllNotification();d(s==null?void 0:s.notifications),m(s==null?void 0:s.totalUnreadDoc),f(s==null?void 0:s.totalDoc),p(1)}catch(s){x(((i=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:i.message)||(s==null?void 0:s.message))}})()},[]),e.jsxs(e.Fragment,{children:[e.jsx(O,{children:"Notifications"}),e.jsx(n.Card,{className:"shadow-xs overflow-hidden bg-white dark:bg-gray-800 mb-5",children:e.jsxs(n.CardBody,{className:"flex justify-between",children:[e.jsx("div",{className:"",children:e.jsxs(n.Button,{disabled:(o==null?void 0:o.length)<1,onClick:B,className:"w-full rounded-md h-10 flex items-center justify-center bg-blue-500 text-white px-1 hover:bg-blue-700",children:[e.jsx("span",{className:"mr-2",children:e.jsx(P,{})}),"Mark is read"]})}),e.jsx("div",{className:"",children:e.jsxs(n.Button,{disabled:(o==null?void 0:o.length)<1,onClick:I,className:"w-full rounded-md h-10 bg-red-500 btn-red",children:[e.jsx("span",{className:"mr-3",children:e.jsx(y,{})}),"Delete"]})})]})}),e.jsx(n.Card,{className:"shadow-xs overflow-hidden bg-white dark:bg-gray-800 mb-5",children:e.jsxs(n.CardBody,{style:{padding:0},children:[e.jsx("div",{className:"p-4 dark:text-gray-300",children:e.jsxs("p",{className:"text-sm font-semibold text-teal-700",children:["Unread Notification (",N,")"]})}),e.jsxs("div",{className:"border rounded-md",children:[e.jsxs("div",{className:"bg-gray-200 border-gray-400 p-2 dark:bg-gray-700 dark:text-gray-400 flex justify-between",children:[e.jsxs("div",{className:"flex",children:[e.jsx(w,{type:"checkbox",name:"selectAll",id:"selectAll",handleClick:M,isChecked:j}),e.jsx("p",{className:"text-xs font-semibold text-gray-500 my-auto dark:text-gray-300 ml-6 uppercase",children:"Notification"})]}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"text-xs font-semibold text-gray-500 my-auto dark:text-gray-300 mr-2 uppercase",children:"Action"})})]}),e.jsx("div",{className:"w-full lg:h-lg md:h-sm h-md relative",children:e.jsx($,{className:"scrollbar-hide",children:e.jsxs(n.TableContainer,{className:"border-none p-2",children:[e.jsx(n.Table,{children:e.jsx(n.TableBody,{className:"w-full h-440",children:r.map((a,i)=>e.jsxs(n.TableRow,{className:"border-none",children:[e.jsx(n.TableCell,{style:{padding:0},children:e.jsx(w,{type:"checkbox",name:a==null?void 0:a._id,id:a._id,handleClick:_,isChecked:o==null?void 0:o.includes(a._id)})}),e.jsx(n.TableCell,{className:"md:w-full w-1/5",style:{paddingRight:0},children:e.jsxs(E,{to:a.productId?`/product/${a.productId}`:`/order/${a.orderId}`,className:"flex items-center",onClick:()=>S(a._id),children:[e.jsx(n.Avatar,{className:"mr-2 md:block hidden bg-gray-50 border border-gray-200",src:a.image,alt:"image"}),e.jsxs("div",{className:"notification-content",children:[e.jsx("div",{className:"md:inline-block hidden",children:e.jsx("h6",{className:"font-medium text-gray-500",children:a==null?void 0:a.message})}),e.jsx("div",{className:"md:hidden",children:e.jsx("h6",{className:"font-medium text-gray-500",children:(a==null?void 0:a.message.substring(0,33))+"..."})}),e.jsxs("p",{className:"flex items-center text-xs text-gray-400",children:[a.productId?e.jsx(n.Badge,{type:"danger",children:"Stock Out"}):e.jsx(n.Badge,{type:"success",children:"New Order"}),e.jsx("span",{className:"ml-2",children:D(a==null?void 0:a.createdAt)})]})]}),a.status==="unread"&&e.jsx("span",{className:"px-2 md:flex hidden focus:outline-none text-blue-600",children:e.jsx("img",{src:L,width:12,height:12,alt:"ellipse",className:"w-3 h-3 text-blue-600"})})]})}),e.jsx(n.TableCell,{className:"text-right",style:{padding:`${window.innerWidth<420?"0":"0.5rem"}`},children:e.jsxs("div",{className:"group inline-block relative",children:[e.jsx("button",{onClick:()=>T(a._id),type:"button",className:"px-2 group-hover:text-blue-500 text-red-500 focus:outline-none",children:e.jsx(y,{})}),e.jsx("div",{className:"absolute hidden group-hover:inline-block bg-gray-50 dark:text-white mr-8 mb-1 right-0 z-50 px-3 py-2 text-sm font-medium text-red-600 rounded-lg shadow-sm tooltip dark:bg-gray-700",children:"Delete"})]})})]},i+1))})}),e.jsx("div",{children:g>5&&r.length!==g?e.jsx("div",{className:"text-center py-2",children:e.jsx("button",{onClick:()=>U(k+1),type:"button",className:"focus:outline-none text-blue-700 hover:underline transition ease-out duration-200 dark:text-gray-400",children:"See more notifications"})}):null})]})})})]})]})})]})};export{V as default};
