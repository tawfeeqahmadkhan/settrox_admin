import{j as e,d as N,r as d,h as ae,S as Y}from"./index-CMwVzeIB.js";import{R as re}from"./index--KU_TfxA.js";import{P as te,M as le}from"./ParentCategory-CmfVHEj-.js";import{a as oe,T as ne}from"./DrawerButton-ORFdy47n.js";import{T as W}from"./SpecificationServices-DpSQCShk.js";import{u as ie,j as ce,l as de}from"./Layout-BjD68e0c.js";import{u as pe,E as C}from"./index.esm-COT8LWOL.js";import{n as A,a as $}from"./toast-Bi8odYBa.js";import{L as t}from"./LabelArea-DxplvXvq.js";import{S as T}from"./SwitchToggle-B5l6JUS2.js";import{P as ge,b as me,C as ue,A as J}from"./ProductServices-BvNfP5wu.js";import{C as he}from"./CurrencyServices-DcYd_dUH.js";import{L as xe}from"./LanguageServices-BvaG6nfs.js";const X=({register:u,name:l,label:P,placeholder:w,required:D,type:S,value:h})=>e.jsx(e.Fragment,{children:e.jsx(N.Textarea,{className:"border text-sm border-gray-200 focus:border-gray-300 block w-full bg-gray-100",...u(`${l}`,{required:D?`${P} is required!`:!1}),type:S,placeholder:w,name:l,value:h,rows:"4",spellCheck:"false"})}),je=(u,l="en",P)=>{const[w,D]=d.useState(""),[S,h]=d.useState([]),p=ae(),[L,U]=d.useState(""),[g,K]=d.useState(!0),[B,j]=d.useState(!0),[i,M]=d.useState([]),[x,_]=d.useState([]),[V,G]=d.useState(!1),[R,b]=d.useState(""),{isBulkDrawerOpen:F,closeBulkDrawer:f,setIsUpdate:y}=d.useContext(Y),{register:q,handleSubmit:O,watch:E,setValue:r,clearErrors:a,formState:{errors:z}}=pe(),H=async v=>{var s,m,o;try{const c={ids:u,categories:i==null?void 0:i.map(n=>n._id),category:(s=x[0])==null?void 0:s._id,productType:[V?"food":"others"],show:v.show,status:g?"show":"hide",tag:JSON.stringify(S)},k={ids:u,status:g?"show":"hide"},I={ids:u,enabled:g?"show":"hide",live_exchange_rates:B?"show":"hide"},Q={ids:u,parentId:L,description:v.description,parentName:R,status:g?"show":"hide"},Z={ids:u,option:v.option,status:g?"show":"hide"},ee={ids:u,currentId:P,changeId:v.groupName,status:g?"show":"hide"},se={ids:u,startTime:v.startTime,endTime:v.endTime,status:g?"show":"hide"};if(p.pathname==="/products"){const n=await ge.updateManyProducts(c);y(!0),A(n.message),f()}if(p.pathname==="/coupons"){const n=await me.updateManyCoupons(se);y(!0),A(n.message),f()}if(p.pathname==="/languages"){const n=await xe.updateManyLanguage(k);y(!0),A(n.message),f()}if(p.pathname==="/currencies"){const n=await he.updateManyCurrencies(I);y(!0),A(n.message),f()}if(p.pathname==="/categories"||p.pathname===`/categories/${P}`){const n=await ue.updateManyCategory(Q);y(!0),A(n.message),f()}if(p.pathname==="/attributes"){const n=await J.updateManyAttribute(Z);y(!0),A(n.message),f()}if(p.pathname===`/attributes/${p.pathname.split("/")[2]}`){const n=await J.updateManyChildAttribute(ee);y(!0),A(n.message),f()}}catch(c){$(((o=(m=c==null?void 0:c.response)==null?void 0:m.data)==null?void 0:o.message)||(c==null?void 0:c.message))}};return d.useEffect(()=>{if(!F){r("parent"),r("children"),r("type"),r("show"),r("name"),D(""),h([]),a("parent"),a("children"),a("type"),a("name"),r("name"),r("iso_code"),r("call_prefix"),r("currency"),r("zone"),a("name"),a("iso_code"),a("call_prefix"),a("currency"),a("zone"),a("status"),r("name"),r("iso_code"),r("country"),r("zone"),r("description"),a("name"),a("iso_code"),a("country"),a("zone"),a("status"),a("show"),a("description"),_([]),M([]);return}},[r,F,a]),d.useEffect(()=>{D(E("children"))},[E,w]),{register:q,watch:E,handleSubmit:O,onSubmit:H,errors:z,tag:S,setTag:h,published:g,setPublished:K,published2:B,setPublished2:j,checked:L,setChecked:U,selectedCategory:i,setSelectedCategory:M,defaultCategory:x,setDefaultCategory:_,selectCategoryName:R,setSelectCategoryName:b,isFoodItem:V,setIsFoodItem:G}},Oe=({ids:u,title:l,lang:P,data:w,childId:D,attributes:S,isCheck:h})=>{const{toggleBulkDrawer:p,isBulkDrawerOpen:L,closeBulkDrawer:U}=d.useContext(Y),{showingTranslateValue:g}=ie(),{tag:K,setTag:B,published:j,register:i,onSubmit:M,errors:x,checked:_,setChecked:V,resetRefTwo:G,handleSubmit:R,setPublished:b,selectedCategory:F,setSelectedCategory:f,defaultCategory:y,setDefaultCategory:q,selectCategoryName:O,setSelectCategoryName:E}=je(u,P,D),r={motionName:"node-motion",motionAppear:!1,onAppearStart:s=>({height:0}),onAppearActive:s=>({height:s.scrollHeight}),onLeaveStart:s=>({height:s.offsetHeight}),onLeaveActive:()=>({height:0})},a=s=>{let m=[];for(let o of s)m.push({title:g(o==null?void 0:o.name),key:o._id,children:o.children.length>0&&a(o.children)});return m},z=(s,m)=>{var o;return s._id===m?s:(o=s==null?void 0:s.children)==null?void 0:o.reduce((c,k)=>c??z(k,m),void 0)},H=s=>{var o,c;const m=h==null?void 0:h.find(k=>k===s);if((h==null?void 0:h.length)===((c=(o=w[0])==null?void 0:o.children)==null?void 0:c.length))return $("This can't be select as a parent category!");if(m!==void 0)return $("This can't be select as a parent category!");if(s===D)return $("This can't be select as a parent category!");{if(s===void 0)return;V(s);const k=w[0],I=z(k,s);E(g(I==null?void 0:I.name))}},v=`
  .rc-tree-child-tree {
    display: hidden;
  }
  .node-motion {
    transition: all .3s;
    overflow-y: hidden;
  }
`;return e.jsx(e.Fragment,{children:e.jsxs(oe,{open:L,onClose:U,parent:null,level:null,placement:"right",children:[e.jsx("button",{onClick:p,className:"absolute z-50 text-red-500 hover:bg-red-100 hover:text-gray-700 transition-colors duration-150 bg-white shadow-md mr-6 mt-6 right-0 left-auto w-10 h-10 rounded-full block text-center",children:e.jsx(ce,{className:"mx-auto"})}),e.jsxs("div",{className:"flex flex-col w-full h-full justify-between",children:[e.jsx("div",{className:"w-full relative p-6 border-b border-gray-100 bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300",children:e.jsx(ne,{title:`Update Selected ${l}`,description:`Apply changes to the selected ${l} from the list`})}),e.jsx(de.Scrollbars,{className:"w-full md:w-7/12 lg:w-8/12 xl:w-8/12 relative dark:bg-gray-700 dark:text-gray-200",children:e.jsxs("form",{onSubmit:R(M),className:"block",children:[e.jsxs("div",{className:"px-6 pt-8 flex-grow w-full h-full max-h-full pb-40 md:pb-32 lg:pb-32 xl:pb-32",children:[l==="Products"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(t,{label:"Categorys"}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(te,{lang:P,selectedCategory:F,setSelectedCategory:f,setDefaultCategory:q})})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(t,{label:"Default Category"}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(le,{displayValue:"name",isObject:!0,singleSelect:!0,ref:G,hidePlaceholder:!0,onKeyPressFn:function(){},onRemove:function(){},onSearch:function(){},onSelect:s=>q(s),selectedValues:y,options:F,placeholder:"Default Category"})})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(t,{label:"Published"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(T,{handleProcess:b,processOption:j}),e.jsx(C,{errorName:x.status})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(t,{label:"Product Tags"}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(re,{placeholder:"Product Tag (Write then press enter to add new tag )",tags:K,onChange:s=>B(s)})})]})]}),l==="Coupons"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(t,{label:"Start Time"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(N.Input,{...i("startTime",{required:"Coupon Validation Start Time"}),label:"Coupon Validation Start Time",name:"startTime",type:"datetime-local",placeholder:"Start Time"}),e.jsx(C,{errorName:x.startTime})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(t,{label:"End Time"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(N.Input,{...i("endTime",{required:"Coupon Validation End Time"}),label:"Coupon Validation End Time",name:"endTime",type:"datetime-local",placeholder:"End Time"}),e.jsx(C,{errorName:x.endTime})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(t,{label:"Published"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(T,{handleProcess:b,processOption:j}),e.jsx(C,{errorName:x.published})]})]})]}),l==="Languages"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(t,{label:"Published"}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(T,{title:"",processOption:j,handleProcess:b})})]})}),l==="Currencies"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(t,{label:"Enabled"}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(T,{title:"",processOption:j,handleProcess:b})})]})}),l==="Categories"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(t,{label:"Description"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(X,{register:i,label:"Description",name:"description",type:"text",placeholder:"Category Description"}),e.jsx(C,{errorName:x.description})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(t,{label:"Parent Category"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(N.Input,{readOnly:!0,...i("parent",{required:!1}),name:"parent",value:O||"Home",placeholder:"parent category",type:"text"}),e.jsxs("div",{className:"draggable-demo capitalize",children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:v}}),e.jsx(W,{treeData:a(w),selectedKeys:[_],onSelect:s=>H(s[0]),motion:r,animation:"slide-up"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(t,{label:"Published"}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(T,{title:"",processOption:j,handleProcess:b})})]})]}),l==="Child Categories"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(t,{label:"Description"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(X,{register:i,label:"Description",name:"description",type:"text",placeholder:"Category Description"}),e.jsx(C,{errorName:x.description})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(t,{label:"Parent Category"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(N.Input,{readOnly:!0,...i("parent",{required:!1}),name:"parent",value:O||"Home",placeholder:"parent category",type:"text"}),e.jsxs("div",{className:"draggable-demo capitalize",children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:v}}),e.jsx(W,{treeData:a(w),selectedKeys:[_],onSelect:s=>H(s[0]),motion:r,animation:"slide-up"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(t,{label:"Published"}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(T,{title:"",processOption:j,handleProcess:b})})]})]}),l==="Attributes"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(t,{label:"Options"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsxs(N.Select,{name:"option",...i("option",{required:"Option is required!"}),children:[e.jsx("option",{value:"",defaultValue:!0,hidden:!0,children:"Select type"}),e.jsx("option",{value:"Dropdown",children:"Dropdown"}),e.jsx("option",{value:"Radio",children:"Radio"})]}),e.jsx(C,{errorName:x.option})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(t,{label:"Published"}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(T,{title:"",processOption:j,handleProcess:b})})]})]}),l==="Attribute Value(s)"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(t,{label:"Change Attribute Group"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsxs(N.Select,{name:"groupName",...i("groupName",{required:!1}),children:[e.jsx("option",{value:"",defaultValue:!0,hidden:!0,children:"Select Attribute Group"}),S==null?void 0:S.map((s,m)=>e.jsx("option",{value:s._id,children:g(s==null?void 0:s.name)},m+1))]}),e.jsx(C,{errorName:x.groupName})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(t,{label:"Published"}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(T,{title:"",processOption:j,handleProcess:b})})]})]})]}),e.jsxs("div",{className:"fixed bottom-0 w-full right-0 py-4 lg:py-8 px-6 grid gap-4 lg:gap-6 xl:gap-6 md:flex xl:flex bg-gray-50 border-t border-gray-100 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300",children:[e.jsx("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsx(N.Button,{onClick:p,className:" text-red-500 hover:bg-red-50 hover:border-red-100 hover:text-red-600 dark:bg-gray-700 dark:border-gray-700 dark:text-gray-500 dark:hover:bg-gray-800 dark:hover:text-red-700",layout:"outline",children:"Cancel"})}),e.jsx("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsxs(N.Button,{type:"submit",className:"h-12 w-full",children:[" ","Bulk Update ",l]})})]})]})})]})]})})};export{Oe as B,X as T};
