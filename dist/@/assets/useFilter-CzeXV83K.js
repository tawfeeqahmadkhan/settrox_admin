import{A as He,c as Xe}from"./browser-G6HRTwGe.js";import{d as N,u as ke}from"./Layout-BjD68e0c.js";import{i as Ge,a as Ke}from"./isToday-tsJAS3Ca.js";import{r as i,h as Qe,S as We}from"./index-CMwVzeIB.js";import{P as Ye,C as le,a as $e,b as ve,A as et}from"./ProductServices-BvNfP5wu.js";import{C as tt}from"./CurrencyServices-DcYd_dUH.js";import{L as at}from"./LanguageServices-BvaG6nfs.js";import"./httpService-y4n1pDxN.js";import{a as l,n as S}from"./toast-Bi8odYBa.js";const ue={type:"object",properties:{_id:{type:"string"},name:{type:"object"},description:{type:"object"},icon:{type:"string"},status:{type:"string"}},required:["name"]},nt={type:"object",properties:{_id:{type:"string"},id:{type:"string"},status:{type:"string"},name:{type:"string"},description:{type:"string"},parentName:{type:"string"},parentId:{type:"string"},icon:{type:"string"}},required:["name"]},st={type:"object",properties:{status:{type:"string"},title:{type:"object"},name:{type:"object"},variants:{type:"array"},option:{type:"string"},type:{type:"string"}},required:["name","title"]},ot={type:"object",properties:{title:{type:"object"},couponCode:{type:"string"},endTime:{type:"string"},discountPercentage:{type:"number"},minimumAmount:{type:"number"},productType:{type:"string"},logo:{type:"string"},discountType:{type:"object"},status:{type:"string"}},required:["title","couponCode","endTime","status"]},it={type:"object",properties:{name:{type:"string"},email:{type:"string"}},required:["name","email"]},Ft=_=>{const L=new He({allErrors:!0}),[J,me]=i.useState(""),[U,fe]=i.useState(""),[V,Q]=i.useState(""),[P,W]=i.useState(""),[y,Y]=i.useState(""),[q,ge]=i.useState(""),[C,$]=i.useState(""),[w,E]=i.useState(""),[b,v]=i.useState(""),[R,ee]=i.useState(""),[Se,ye]=i.useState(""),[O,Ce]=i.useState(""),[M,we]=i.useState(""),[be,he]=i.useState([]),[Le,De]=i.useState([]),[Ae,Pe]=i.useState([]),[z,Re]=i.useState(""),[Z,Oe]=i.useState(""),[j,Te]=i.useState(""),[H,Ne]=i.useState(1),[_e,te]=i.useState([]),[je,Fe]=i.useState(""),[Ie,xe]=i.useState(""),[Be,Je]=i.useState(""),[u,X]=i.useState([]),[Ue,F]=i.useState(""),[Ve,I]=i.useState(!1),[k,qe]=i.useState(""),[G]=i.useState([]),ae=i.useRef(""),ne=i.useRef(""),se=i.useRef(""),oe=i.useRef(""),ie=i.useRef(""),K=i.useRef(""),x=i.useRef(""),re=i.useRef(""),de=i.useRef(""),pe=i.useRef(""),Ee=i.useRef(""),ce=i.useRef("");N.extend(Ge),N.extend(Ke);const p=Qe(),{lang:D,setIsUpdate:h,setLoading:c}=i.useContext(We),{globalSetting:A}=ke(),g=i.useMemo(()=>{const r=new Date;r.setDate(r.getDate()-j);let t=_==null?void 0:_.map(e=>{const o=new Date(e==null?void 0:e.updatedAt).toLocaleString("en-US",{timeZone:A==null?void 0:A.default_time_zone});return{...e,updatedDate:o==="Invalid Date"?"":o}});if(p.pathname==="/dashboard"){const e=t==null?void 0:t.filter(f=>f.status==="Pending");he(e);const o=t==null?void 0:t.filter(f=>f.status==="Processing");De(o);const a=t==null?void 0:t.filter(f=>f.status==="Delivered");Pe(a);const d=t==null?void 0:t.filter(f=>N(f.createdAt).isToday()),m=d==null?void 0:d.reduce((f,T)=>f+T.total,0);Fe(m);const n=t==null?void 0:t.filter(f=>N(f.createdAt).isBetween(new Date().setDate(new Date().getDate()-30),new Date)),s=n==null?void 0:n.reduce((f,T)=>f+T.total,0);xe(s);const Ze=t==null?void 0:t.reduce((f,T)=>f+T.total,0);Je(Ze)}return J&&(t=t.filter(e=>e.parent===J)),U==="Low"&&(t=t.sort((e,o)=>e.price<o.price&&-1)),U==="High"&&(t=t.sort((e,o)=>e.price>o.price&&-1)),V&&(t=t.filter(e=>{var o;return(o=e==null?void 0:e.title)==null?void 0:o.toLowerCase().includes(V.toLowerCase())})),b&&(t=t.filter(e=>{var o,a,d;return((a=(o=e==null?void 0:e.title[D])==null?void 0:o.toLowerCase())==null?void 0:a.includes(b==null?void 0:b.toLowerCase()))||((d=e==null?void 0:e.attribute)==null?void 0:d.toLowerCase().includes(b==null?void 0:b.toLowerCase()))})),C&&(t=t.filter(e=>{var o,a,d;return((a=(o=e==null?void 0:e.name[D])==null?void 0:o.toLowerCase())==null?void 0:a.includes(C==null?void 0:C.toLowerCase()))||((d=e==null?void 0:e.category)==null?void 0:d.toLowerCase().includes(C==null?void 0:C.toLowerCase()))})),w&&(t=t.filter(e=>{var o,a,d;return((a=(o=e==null?void 0:e.name[D])==null?void 0:o.toLowerCase())==null?void 0:a.includes(w==null?void 0:w.toLowerCase()))||((d=e==null?void 0:e.brand)==null?void 0:d.toLowerCase().includes(w==null?void 0:w.toLowerCase()))})),Z&&(t=t.filter(e=>e.role===Z)),P&&(t=t.filter(e=>{var o,a,d;return((o=e==null?void 0:e.name[D])==null?void 0:o.toLowerCase().includes(P.toLowerCase()))||((a=e==null?void 0:e.phone)==null?void 0:a.toLowerCase().includes(P.toLowerCase()))||((d=e==null?void 0:e.email)==null?void 0:d.toLowerCase().includes(P.toLowerCase()))})),y&&(t=t==null?void 0:t.filter(e=>{var o,a,d;return((a=(o=e==null?void 0:e.title[D])==null?void 0:o.toLowerCase())==null?void 0:a.includes(y==null?void 0:y.toLowerCase()))||((d=e==null?void 0:e.couponCode)==null?void 0:d.toLowerCase().includes(y==null?void 0:y.toLowerCase()))})),z&&(t=t.filter(e=>e.status===z)),q&&(t=t.filter(e=>e.contact.toLowerCase().includes(q.toLowerCase()))),j&&(t=t.filter(e=>N(e.createdAt).isBetween(r,new Date))),R&&(t=t.filter(e=>{var o,a;return((o=e==null?void 0:e.name)==null?void 0:o.toLowerCase().includes(R.toLowerCase()))||((a=e==null?void 0:e.iso_code)==null?void 0:a.toLowerCase().includes(R.toLowerCase()))})),k&&(t=t.filter(e=>e==null?void 0:e.name.toLowerCase().includes(k.toLowerCase()))),O&&(t=t.filter(e=>e.name.toLowerCase().includes(O.toLowerCase())||e.iso_code.toLowerCase().includes(O.toLowerCase())||e.language_code.toLowerCase().includes(O.toLowerCase()))),M&&(t=t.filter(e=>e.iso_code.toLowerCase().includes(M.toLowerCase()))),t},[j,_,p.pathname,J,U,V,b,C,w,Z,P,y,z,q,R,k,O,M,K,x,A==null?void 0:A.default_time_zone,D]),B=20,Me=g==null?void 0:g.length,ze=r=>{Ne(r)};return i.useEffect(()=>{console.log(g,"*******************************"),te(g==null?void 0:g.slice((H-1)*B,H*B))},[g,H,B]),{userRef:se,searchRef:ne,couponRef:oe,orderRef:ie,categoryRef:K,brandRef:x,attributeRef:re,pending:be,processing:Le,delivered:Ae,todayOrder:je,monthlyOrder:Ie,totalOrder:Be,setFilter:me,setSortedField:fe,setStatus:Re,setRole:Oe,time:j,zone:Se,setTime:Te,taxRef:Ee,setZone:ye,filename:Ue,countryRef:de,dataTable:_e,serviceData:g,country:R,setSearchText:Q,setCountry:ee,isDisabled:Ve,languageRef:pe,currencyRef:ae,shippingRef:ce,setSearchUser:W,setDataTable:te,setCategoryType:$,setBrandType:E,setBrandType:E,handleChangePage:ze,totalResults:Me,resultsPerPage:B,handleOnDrop:r=>{for(let t=0;t<r.length;t++)G.push(r[t].data)},setSearchCoupon:Y,setAttributeTitle:v,handleSelectFile:r=>{var o;r.preventDefault();const t=new FileReader,e=(o=r.target)==null?void 0:o.files[0];e&&e.type==="application/json"?(F(e==null?void 0:e.name),I(!0),console.log("if"),t.readAsText(e,"UTF-8"),t.onload=a=>{let d=JSON.parse(a.target.result),m=[];p.pathname==="/categories"&&(m=d.map(n=>({_id:n._id,id:n.id,status:n.status,name:n.name,description:n.description,parentName:n.parentName,parentId:n.parentId,icon:n.icon}))),p.pathname==="/sub-categories"&&(m=d.map(n=>({_id:n._id,id:n.id,status:n.status,name:n.name,description:n.description,parentName:n.parentName,parentId:n.parentId,icon:n.icon}))),p.pathname==="/brand"&&(m=d.map(n=>({_id:n._id,id:n.id,status:n.status,name:n.name,description:n.description,parentName:n.parentName,parentId:n.parentId,icon:n.icon}))),p.pathname==="/attributes"&&(m=d.map(n=>({_id:n._id,status:n.status,title:n.title,name:n.name,variants:n.variants,option:n.option,type:n.type}))),p.pathname==="/coupons"&&(m=d.map(n=>({title:n.title,couponCode:n.couponCode,endTime:n.endTime,discountPercentage:n.discountPercentage,minimumAmount:n.minimumAmount,productType:n.productType,logo:n.logo,discountType:n.discountType,status:n.status}))),p.pathname==="/customers"&&(m=d.map(n=>({name:n.name,email:n.email,password:n.password,phone:n.phone}))),X(m)}):e&&e.type==="text/csv"?(F(e==null?void 0:e.name),I(!0),console.log("else if"),t.onload=async a=>{const d=a.target.result,m=await Xe().fromString(d);let n=[];p.pathname==="/categories"&&(n=m.map(s=>({_id:s._id,id:s.id,status:s.status,name:JSON.parse(s.name),description:JSON.parse(s.description),parentName:s.parentName,parentId:s.parentId,icon:s.icon}))),p.pathname==="/sub-categories"&&(n=d.map(s=>({_id:s._id,id:s.id,status:s.status,name:s.name,description:s.description,parentName:s.parentName,parentId:s.parentId,icon:s.icon}))),p.pathname==="/brand"&&(n=m.map(s=>({_id:s._id,id:s.id,status:s.status,name:JSON.parse(s.name),description:JSON.parse(s.description),parentName:s.parentName,parentId:s.parentId,icon:s.icon}))),p.pathname==="/attributes"&&(n=m.map(s=>({status:s.status,title:JSON.parse(s.title),name:JSON.parse(s.name),variants:JSON.parse(s.variants),option:s.option,type:s.type}))),p.pathname==="/coupons"&&(n=m.map(s=>({title:JSON.parse(s.title),couponCode:s.couponCode,endTime:s.endTime,discountPercentage:s.discountPercentage?JSON.parse(s.discountPercentage):0,minimumAmount:s.minimumAmount?JSON.parse(s.minimumAmount):0,productType:s.productType,logo:s.logo,status:s.status}))),p.pathname==="/customers"&&(n=m.map(s=>({name:s.name,email:s.email,password:s.password,phone:s.phone}))),X(n)},t.readAsText(e)):(F(e==null?void 0:e.name),I(!0),l("Unsupported file type!"))},handleSubmitUser:r=>{r.preventDefault(),W(se.current.value)},handleSubmitForAll:r=>{r.preventDefault(),Q(ne.current.value)},handleSubmitCoupon:r=>{r.preventDefault(),Y(oe.current.value)},handleSubmitOrder:r=>{r.preventDefault(),ge(ie.current.value)},handleSubmitCategory:r=>{r.preventDefault(),$(K.current.value)},handleSubmitBrand:r=>{console.log("***********************",x.current.value),r.preventDefault(),E(x.current.value)},handleSubmitAttribute:r=>{r.preventDefault(),v(re.current.value)},handleUploadProducts:()=>{G.length<1?l("Please upload/select csv file first!"):Ye.addAllProducts(G).then(r=>{S(r.message)}).catch(r=>l(r.message))},handleSubmitCountry:r=>{r.preventDefault(),ee(de.current.value)},handleSubmitCurrency:r=>{r.preventDefault(),we(ae.current.value)},handleSubmitShipping:r=>{r.preventDefault(),qe(ce.current.value)},handleSubmitLanguage:r=>{r.preventDefault(),Ce(pe.current.value)},handleUploadMultiple:r=>{if(u.length>1){if(p.pathname==="/categories"){c(!0);let t=u.map(a=>L.validate(ue,a));const e=a=>a===!0;t.every(e)?le.addAllCategory(u).then(a=>{c(!1),h(!0),S(a.message)}).catch(a=>{c(!1),l(a?a.response.data.message:a.message)}):l("Please enter valid data!")}if(p.pathname==="/sub-categories"){c(!0);let t=u.map(a=>L.validate(ue,a));const e=a=>a===!0;t.every(e)?le.addAllCategory(u).then(a=>{c(!1),h(!0),S(a.message)}).catch(a=>{c(!1),l(a?a.response.data.message:a.message)}):l("Please enter valid data!")}if(p.pathname==="/brand"&&(c(!0),u.map(o=>L.validate(nt,o)).every(o=>o===!0)?BrandServices.addAllBrands(u).then(o=>{c(!1),h(!0),S(o.message)}).catch(o=>{c(!1),l(o?o.response.data.message:o.message)}):(c(!1),l("Please enter valid data!"))),p.pathname==="/customers"){c(!0);let t=u.map(a=>L.validate(it,a));const e=a=>a===!0;t.every(e)?$e.addAllCustomers(u).then(a=>{c(!1),h(!0),S(a.message)}).catch(a=>{c(!1),l(a?a.response.data.message:a.message)}):l("Please enter valid data!")}if(p.pathname==="/coupons"){c(!0);let t=u.map(a=>L.validate(ot,a));const e=a=>a===!0;t.every(e)?ve.addAllCoupon(u).then(a=>{c(!1),h(!0),S(a.message)}).catch(a=>{c(!1),l(a?a.response.data.message:a.message)}):l("Please enter valid data!")}if(p.pathname==="/attributes"){c(!0);let t=u.map(a=>L.validate(st,a));const e=a=>a===!0;t.every(e)?et.addAllAttributes(u).then(a=>{c(!1),h(!0),S(a.message)}).catch(a=>{c(!1),l(a?a.response.data.message:a.message)}):l("Please enter valid data!")}p.pathname==="/languages"&&at.addAllLanguage(u).then(t=>{h(!0),S(t.message)}).catch(t=>l(t?t.response.data.message:t.message)),p.pathname==="/currencies"&&tt.addAllCurrency(u).then(t=>{h(!0),S(t.message)}).catch(t=>l(t?t.response.data.message:t.message))}else l("Please select a valid .JSON/.CSV/.XLS file first!")},handleRemoveSelectFile:r=>{F(""),X([]),setTimeout(()=>I(!1),1e3)}}};export{Ft as u};
