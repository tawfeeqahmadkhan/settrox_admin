import{r as c,S as z,f as Y,j as e,d as i}from"./index-CMwVzeIB.js";import{u as G,S as ee,a as te,b as le}from"./Layout-BjD68e0c.js";import{u as V}from"./useAsync-3D9_nwwI.js";import{S as B,T as ae}from"./SpecificationServices-DpSQCShk.js";import{T as q,D as se,u as J,M as Q}from"./DrawerButton-ORFdy47n.js";import{u as re}from"./useFilter-CzeXV83K.js";import{D as W,E as ne}from"./EditDeleteButton-CYYmh68G.js";import{P as ie}from"./PageTitle-CiYCa1gH.js";/* empty css                      */import{u as oe,E as O}from"./index.esm-COT8LWOL.js";import{I as de}from"./InputArea-Bkb2-nDq.js";import{L}from"./LabelArea-DxplvXvq.js";import{S as ce}from"./SwitchToggle-B5l6JUS2.js";import{a as K,n as $}from"./toast-Bi8odYBa.js";import"./httpService-y4n1pDxN.js";import{C as me}from"./ProductServices-BvNfP5wu.js";import"./exportFromJSON-BvevaQwb.js";import"./index.prod-bp3Z4JqG.js";import{T as ge}from"./TableLoading-UbVPBLmP.js";import{C as X,S as he}from"./ShowHideButton-BYPQhCd6.js";import{N as ue}from"./Tooltip-CK2c9wXD.js";import{A as xe}from"./AnimatedContent-BUFKB-yB.js";import"./iconBase-E_75oB0f.js";import"./useDispatch-DX3rZxrl.js";import"./SelectLanguageTwo-BgAeF8hI.js";import"./LanguageServices-BvaG6nfs.js";import"./spinner-CkndCogW.js";import"./browser-G6HRTwGe.js";import"./index-DJ3uWcwx.js";import"./isToday-tsJAS3Ca.js";import"./CurrencyServices-DcYd_dUH.js";import"./AdminServices-D9Q4xkaE.js";import"./BrandServices-Jo5NrGFc.js";import"./index-V2XaSKc-.js";import"./react-tooltip.min-DdxQKMRK.js";const pe=(g,j)=>{const{isDrawerOpen:r,closeDrawer:b,setIsUpdate:h,lang:N}=c.useContext(z),[I,C]=c.useState({}),[w,o]=c.useState(""),[T,S]=c.useState([]),[x,n]=c.useState(N),[u,d]=c.useState(!0),[f,F]=c.useState(""),[M,v]=c.useState(!1),[k,E]=c.useState([{label:"",value:""}]),{register:P,handleSubmit:_,setValue:m,clearErrors:p,reset:D,formState:{errors:A}}=oe(),R=t=>{for(const a in t)t[a].trim()===""&&delete t[a];return t};console.log("selectCategoryName:",f);const s=async({title:t})=>{var a,U;console.log("Submitting data:",t);try{v(!0);const y={title:R({[x]:t}),attributes:k,categoryId:w||void 0,parentName:f||"Home",status:u?"show":"hide",lang:x};if(g){const H=await B.updateSpecification(g,y);h(!0),v(!1),$(H.message),b(),D()}else{console.log("specificationData",y);const H=await B.addSpecification(y);h(!0),v(!1),$(H.message),b()}}catch(y){v(!1),K(y?(U=(a=y==null?void 0:y.response)==null?void 0:a.data)==null?void 0:U.message:y==null?void 0:y.message),b()}},l=t=>{n(t),Object.keys(I).length>0&&m("title",I.name[t||"en"])};return c.useEffect(()=>{var t;if(!r){C({}),m("title"),m("parentId"),m("parentName"),m("label"),m("value"),d(!0),p("title"),p("parentId"),p("parentName"),p("label"),p("value"),F("Home"),n(N),m("language",x),j!==void 0&&((t=j[0])==null?void 0:t._id)!==void 0&&o(j[0]._id);return}g&&(async()=>{try{const a=await B.getSpecificationById(g);a&&(C(a),m("title",a.title[x||"en"]),m("language",x),m("parentId",a.categoryId),m("parentName",a.parentName),F(a.parentName),E(a.attributes),o(a.categoryId),d(a.status))}catch(a){K(a?a.response.data.message:a.message)}})()},[g,m,r,x,p,j,N]),{register:P,handleSubmit:_,onSubmit:s,errors:A,children:T,setChildren:S,published:u,setPublished:d,checked:w,setChecked:o,isSubmitting:M,selectCategoryName:f,attributes:k,setSelectCategoryName:F,setAttributes:E,handleSelectLanguage:l}},Z=({id:g,data:j})=>{const{t:r}=Y(),{checked:b,register:h,onSubmit:N,handleSubmit:I,errors:C,published:w,setPublished:o,setChecked:T,handleSelectLanguage:S,isSubmitting:x,selectCategoryName:n,setSelectCategoryName:u,attributes:d,setAttributes:f}=pe(g,j),[F,M]=c.useState(!1),{showingTranslateValue:v}=G(),k=()=>{f([...d,{label:"",value:""}])},E=s=>{const l=d.filter((t,a)=>a!==s);f(l)},P=(s,l,t)=>{const a=[...d];a[s][l]=t,console.log("updatedAttributes",a),f(a)},_=`
  .rc-tree-child-tree {
    display: hidden;
  }
  .node-motion {
    transition: all .3s;
    overflow-y: hidden;
  }
`,m={motionName:"node-motion",motionAppear:!1,onAppearStart:s=>({height:0}),onAppearActive:s=>({height:s.scrollHeight}),onLeaveStart:s=>({height:s.offsetHeight}),onLeaveActive:()=>({height:0})},p=s=>{let l=[];if(typeof s<"u")for(let t of s)l.push({title:v(t.name),key:t._id,children:t.children.length>0&&p(t.children)});return l},D=async s=>{if(console.log("key",s,"id",g),s!==void 0)if(g){if(s===void 0)return;T(s);let l={};for(const t of A)if(t._id===s&&(l=t),t.children&&t.children.length>0)for(const a of t.children)a._id===s&&(l=a);console.log("selectedDataObj",l),u(v(l==null?void 0:l.name))}else{if(s===void 0)return;T(s);let l={};for(const t of A)if(t._id===s&&(l=t),t.children&&t.children.length>0)for(const a of t.children)a._id===s&&(l=a);console.log("selectedDataObj",l),u(v(l==null?void 0:l.name))}},[A,R]=c.useState(null);return c.useEffect(()=>{(async()=>{try{const l=await me.getAllCategory();R(l),console.log("Fetched categorydata:",l)}catch(l){console.error("Error fetching categorydata:",l)}})()},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full relative p-6 border-b border-gray-100 bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300",children:g?e.jsx(q,{register:h,handleSelectLanguage:S,title:r("UpdateSpecification"),description:r("Update Specification Description")}):e.jsx(q,{register:h,handleSelectLanguage:S,title:r("AddSpecificationTitle"),description:r("Add Specification Description")})}),e.jsx(ee,{className:"w-full md:w-7/12 lg:w-8/12 xl:w-8/12 relative dark:bg-gray-700 dark:text-gray-200",children:e.jsxs("form",{onSubmit:I(N),children:[e.jsxs("div",{className:"p-6 flex-grow scrollbar-hide w-full max-h-full pb-40",children:[e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(L,{label:r("ParentCategory")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4 relative",children:[e.jsx(i.Input,{readOnly:!0,...h("parent",{required:!1}),name:"parent",value:n||"",placeholder:r("ParentCategory"),type:"text"}),e.jsxs("div",{className:"draggable-demo capitalize",children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:_}}),A&&A.length>0?e.jsx(ae,{expandAction:"click",treeData:p(A),selectedKeys:[b],onSelect:s=>D(s[0]),motion:m,animation:"slide-up"}):e.jsx("p",{children:"No categories available"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(L,{label:r("Title")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(de,{required:!0,register:h,label:"Specification title",name:"title",type:"text",placeholder:r("Title")}),e.jsx(O,{errorName:C.title})]})]}),d&&d.map((s,l)=>e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(L,{label:r("Label")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(i.Input,{required:!0,register:h,label:"Label",name:"label[]",type:"text",placeholder:r("Label"),value:s.label,onChange:t=>{console.log(`Input Changed: Field - label, Value - ${t.target.value}`),P(l,"label",t.target.value)}}),e.jsx(O,{errorName:C.label})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(L,{label:r("Value")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(i.Input,{required:!0,register:h,label:"Value",name:"value[]",type:"text",placeholder:r("value"),value:s.value,onChange:t=>P(l,"value",t.target.value)}),e.jsx(O,{errorName:C.value})]}),l!=0&&d.length>1&&e.jsx("button",{type:"button",onClick:()=>E(l),className:"px-3 py-2 text-white bg-red-500 rounded-md hover:bg-red-600 float-right",children:"Remove"})]})]},l)),e.jsx("div",{children:e.jsx("button",{type:"button",onClick:k,className:"mt-4 px-4 py-2 text-white bg-blue-500 rounded-md hover:bg-blue-600",children:"Add Attribute"})}),e.jsxs("div",{className:"mt-6 grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(L,{label:r("Published")}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(ce,{handleProcess:o,processOption:w})})]})]}),e.jsx(se,{id:g,title:"Specification",isSubmitting:x||F})]})})]})},be=({data:g,lang:j,isCheck:r,specificationArray:b,setIsCheck:h,useParamId:N,showChild:I})=>{const{title:C,serviceId:w,handleModalOpen:o,handleUpdate:T}=J(),{showingTranslateValue:S}=G(),x=n=>{const{id:u,checked:d}=n.target;h([...r,u]),d||h(r.filter(f=>f!==u))};return e.jsxs(e.Fragment,{children:[(r==null?void 0:r.length)<1&&e.jsx(W,{useParamId:N,id:w,title:C}),e.jsx(Q,{children:e.jsx(Z,{id:w,data:g,lang:j})}),e.jsx(i.TableBody,{children:b&&(b==null?void 0:b.map(n=>{var u;return e.jsxs(i.TableRow,{children:[e.jsx(i.TableCell,{children:e.jsx(X,{type:"checkbox",name:"specification",id:n._id,handleClick:x,isChecked:r==null?void 0:r.includes(n._id)})}),e.jsx(i.TableCell,{className:"font-semibold uppercase text-xs",children:(u=n==null?void 0:n._id)==null?void 0:u.substring(20,24)}),e.jsx(i.TableCell,{className:"font-medium text-sm ",children:e.jsx("span",{children:S(n==null?void 0:n.title)})}),e.jsx(i.TableCell,{className:"text-sm",children:S(n==null?void 0:n.categoryName)}),e.jsx(i.TableCell,{className:"text-center",children:e.jsx(he,{id:n._id,specification:!0,status:n.status})}),e.jsx(i.TableCell,{children:e.jsx(ne,{id:n==null?void 0:n._id,parent:n,isCheck:r,handleUpdate:T,handleModalOpen:o,title:S(n==null?void 0:n.title)})})]},n._id)}))})]})},Ze=()=>{const{toggleDrawer:g,lang:j}=c.useContext(z),{data:r,loading:b,error:h}=V(B.getAllSpecification);V(B.getAllCategories);const{handleDeleteMany:N,allId:I,handleUpdateMany:C,serviceId:w}=J(),{t:o}=Y(),{handleSubmitSpecification:T,specificationRef:S,totalResults:x,resultsPerPage:n,dataTable:u,serviceData:d,handleChangePage:f,filename:F,isDisabled:M,setSpecificationType:v,handleSelectFile:k,handleUploadMultiple:E,handleRemoveSelectFile:P}=re(r),[_,m]=c.useState(!1),[p,D]=c.useState([]),[A,R]=c.useState(!1),s=()=>{var t;m(!_),D((t=r[0])==null?void 0:t.children.map(a=>a._id)),_&&D([])},l=()=>{v(""),S.current.value=""};return console.log("serviceData",d,"tableData",u),e.jsxs(e.Fragment,{children:[e.jsx(ie,{children:o("Specification")}),e.jsx(W,{ids:I,setIsCheck:D}),e.jsx(Q,{children:e.jsx(Z,{id:w,data:r,lang:j})}),e.jsxs(xe,{children:[e.jsx(i.Card,{className:"min-w-0 shadow-xs overflow-hidden bg-white dark:bg-gray-800 mb-5",children:e.jsx(i.CardBody,{className:"",children:e.jsxs("form",{onSubmit:T,className:"py-3  grid gap-4 lg:gap-6 xl:gap-6  xl:flex",children:[e.jsx("div",{className:"flex justify-start w-1/2 xl:w-1/2 md:w-full"}),e.jsxs("div",{className:"lg:flex  md:flex xl:justify-end xl:w-1/2  md:w-full md:justify-start flex-grow-0",children:[e.jsx("div",{className:"w-full md:w-32 lg:w-32 xl:w-32  mr-3 mb-3 lg:mb-0",children:e.jsxs(i.Button,{disabled:p.length<1,onClick:()=>N(p),className:"w-full rounded-md h-12 bg-red-500 disabled  btn-red",children:[e.jsx("span",{className:"mr-2",children:e.jsx(te,{})}),o("Delete")]})}),e.jsx("div",{className:"w-full md:w-48 lg:w-48 xl:w-48",children:e.jsxs(i.Button,{onClick:g,className:"rounded-md h-12 w-full",children:[e.jsx("span",{className:"mr-2",children:e.jsx(le,{})}),o("AddSpecification")]})})]})]})})}),e.jsx(i.Card,{className:"min-w-0 shadow-xs overflow-hidden bg-white dark:bg-gray-800 rounded-t-lg rounded-0 mb-4",children:e.jsx(i.CardBody,{children:e.jsxs("form",{onSubmit:T,className:"py-3 grid gap-4 lg:gap-6 xl:gap-6 md:flex xl:flex",children:[e.jsx("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsx(i.Input,{ref:S,type:"search",placeholder:o("SearchSpecification")})}),e.jsxs("div",{className:"flex items-center gap-2 flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:[e.jsx("div",{className:"w-full mx-1",children:e.jsx(i.Button,{type:"submit",className:"h-12 w-full bg-blue-700",children:"Filter"})}),e.jsx("div",{className:"w-full mx-1",children:e.jsx(i.Button,{layout:"outline",onClick:l,type:"reset",className:"px-4 md:py-1 py-2 h-12 text-sm dark:bg-gray-700",children:e.jsx("span",{className:"text-black dark:text-gray-200",children:"Reset"})})})]})]})})})]}),b?e.jsx(ge,{row:12,col:6,width:190,height:20}):h?e.jsx("span",{className:"text-center mx-auto text-red-500",children:h}):(d==null?void 0:d.length)!==0?e.jsxs(i.TableContainer,{className:"mb-8",children:[e.jsxs(i.Table,{children:[e.jsx(i.TableHeader,{children:e.jsxs("tr",{children:[e.jsx(i.TableCell,{children:e.jsx(X,{type:"checkbox",name:"selectAll",id:"selectAll",handleClick:s,isChecked:_})}),e.jsx(i.TableCell,{children:o("catIdTbl")}),e.jsx(i.TableCell,{children:o("specification")}),e.jsx(i.TableCell,{children:o("category")}),e.jsx(i.TableCell,{className:"text-center",children:o("catPublishedTbl")}),e.jsx(i.TableCell,{className:"text-right",children:o("catActionsTbl")})]})}),e.jsx(be,{data:r,lang:j,isCheck:p,specificationArray:u,setIsCheck:D,showChild:A})]}),e.jsx(i.TableFooter,{children:e.jsx(i.Pagination,{totalResults:x,resultsPerPage:n,onChange:f,label:"Table navigation"})})]}):e.jsx(ue,{title:"Sorry, There are no specificationArray right now."})]})};export{Ze as default};
